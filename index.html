<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameCreators - Sistema de Gest√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        .main-app {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-tab {
            padding: 12px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            font-size: 14px;
        }

        .nav-tab.active {
            background: #2196F3;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2196F3;
        }

        .btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: #1976D2;
        }

        .btn-secondary { background: #FF9800; }
        .btn-danger { background: #f44336; }
        .btn-success { background: #4CAF50; }
        .btn-warning { background: #FF9800; }
        .btn-small { padding: 6px 12px; font-size: 12px; }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .table th {
            background: #f5f5f5;
            font-weight: 600;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
        }

        .modal-content {
            background: white;
            margin: 2% auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 10001;
            transform: translateX(400px);
            transition: transform 0.3s;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success { background: #4CAF50; }
        .notification.error { background: #f44336; }
        .notification.info { background: #2196F3; }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-size: 12px;
            font-weight: 500;
        }

        .status-ativo { background: #4CAF50; }
        .status-inadimplente { background: #f44336; }
        .status-cancelado { background: #9E9E9E; }
        .status-trancado { background: #FF9800; }
        .status-formado { background: #4CAF50; }
        .status-pago { background: #4CAF50; }
        .status-pendente { background: #FF9800; }
        .status-vencido { background: #f44336; }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            transition: width 0.3s;
        }

        .document-preview {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
        }

        .document-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .points-display {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #333;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
        }

        .achievement-badge {
            background: #4CAF50;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            margin: 2px;
            display: inline-block;
        }

        .store-item {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .store-item:hover {
            border-color: #2196F3;
            background: #f8f9ff;
        }

        .commission-card {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .level-indicator {
            background: linear-gradient(135deg, #9C27B0, #673AB7);
            color: white;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
        }

        .hidden { display: none !important; }

        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .nav-tabs { flex-direction: column; }
            .nav-tab { border-radius: 8px; margin-bottom: 5px; }
        }

        @media print {
            body * { visibility: hidden; }
            .document-preview, .document-preview * { visibility: visible; }
            .document-preview {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <h1 style="color: #2196F3; margin-bottom: 30px;">GameCreators</h1>
            <h2 style="color: #666; margin-bottom: 30px;">Sistema de Gest√£o</h2>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="Digite seu email">
            </div>
            <div class="form-group">
                <label for="password">Senha:</label>
                <input type="password" id="password" placeholder="Digite sua senha">
            </div>
            <button class="btn" onclick="login()">Entrar</button>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="main-app">
        <div class="header">
            <div>
                <h1>GameCreators - Sistema de Gest√£o</h1>
                <p id="userWelcome">Bem-vindo!</p>
            </div>
            <button class="btn" onclick="logout()" style="background: #f44336;">Sair</button>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs" id="navTabs"></div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div id="alerts"></div>
            <div class="stats-grid" id="statsGrid"></div>
            <div class="card">
                <h3 class="card-title">Resumo Financeiro</h3>
                <div class="grid-3">
                    <div class="stat-card" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                        <div class="stat-number" id="totalReceita">R$ 0,00</div>
                        <div class="stat-label">Receita Total</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);">
                        <div class="stat-number" id="totalVencido">R$ 0,00</div>
                        <div class="stat-label">Vencidos</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);">
                        <div class="stat-number" id="totalPendente">R$ 0,00</div>
                        <div class="stat-label">Pendentes</div>
                    </div>
                </div>
            </div>
            <div class="card">
                <h3 class="card-title">Atividades Recentes</h3>
                <div id="recentActivities"></div>
            </div>
        </div>

        <!-- Students Tab -->
        <div id="students" class="tab-content">
            <div class="action-buttons">
                <h2>Gest√£o de Participantes</h2>
                <button class="btn" onclick="openModal('studentModal')">Novo Participante</button>
                <button class="btn btn-secondary" onclick="openModal('advancedSearchModal')">üîç Busca</button>
                <button class="btn btn-warning" onclick="openModal('statusModal')">Alterar Status</button>
            </div>
            <input type="text" id="studentSearch" placeholder="Buscar participante..." onkeyup="searchTable(this.value)" style="width: 300px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; margin-bottom: 20px;">
            <table class="table" id="studentsTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Curso</th>
                        <th>Status</th>
                        <th>Progresso</th>
                        <th>Pontos</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="studentsTableBody"></tbody>
            </table>
        </div>

        <!-- Classes Tab -->
        <div id="turmas" class="tab-content">
            <div class="action-buttons">
                <h2>Gest√£o de Turmas</h2>
                <button class="btn" onclick="openModal('turmaModal')">Nova Turma</button>
            </div>
            <div id="turmasContainer"></div>
        </div>

        <!-- Financial Tab -->
        <div id="financeiro" class="tab-content">
            <h2>Controle Financeiro</h2>
            <div class="stats-grid">
                <div class="stat-card" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                    <div class="stat-number" id="totalReceita2">R$ 0,00</div>
                    <div class="stat-label">Receita Total</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);">
                    <div class="stat-number" id="totalVencido2">R$ 0,00</div>
                    <div class="stat-label">Vencidos</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);">
                    <div class="stat-number" id="totalPendente2">R$ 0,00</div>
                    <div class="stat-label">Pendentes</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn" onclick="openModal('paymentModal')">Registrar Pagamento</button>
                <button class="btn btn-secondary" onclick="generateFinancialReport()">Relat√≥rio</button>
                <button class="btn btn-success" onclick="openModal('boletoModal')">Gerar Boleto</button>
            </div>

            <div class="card">
                <h3 class="card-title">Controle de Pagamentos</h3>
                <table class="table" id="paymentsTable">
                    <thead>
                        <tr>
                            <th>Participante</th>
                            <th>Parcela</th>
                            <th>Valor</th>
                            <th>Vencimento</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="paymentsTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Documents Tab -->
        <div id="documentos" class="tab-content">
            <h2>Documentos e Contratos</h2>
            <div class="action-buttons">
                <button class="btn" onclick="openModal('documentModal')">Gerar Documento</button>
                <button class="btn btn-secondary" onclick="openModal('templateModal')">Templates</button>
            </div>
            <div id="documentPreview"></div>
        </div>

        <!-- Progress Tab -->
        <div id="progresso" class="tab-content">
            <h2>Acompanhamento Acad√™mico</h2>
            <div class="action-buttons">
                <button class="btn" onclick="openModal('progressModal')">Atualizar Progresso</button>
                <button class="btn btn-secondary" onclick="generateProgressReport()">Relat√≥rio</button>
            </div>
            <div id="progressContainer"></div>
        </div>

        <!-- Attendance Tab -->
        <div id="chamada" class="tab-content">
            <h2>Controle de Presen√ßa</h2>
            <div class="card">
                <h3 class="card-title">Chamada da Turma</h3>
                <div class="grid-3">
                    <div class="form-group">
                        <label>Turma:</label>
                        <select id="attendanceClass">
                            <option value="">Selecione uma turma</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Data:</label>
                        <input type="date" id="attendanceDate">
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button class="btn" onclick="loadAttendanceList()">Carregar Lista</button>
                    </div>
                </div>
            </div>
            <div id="attendanceList" class="card hidden">
                <h3 class="card-title">Lista de Presen√ßa</h3>
                <div id="attendanceStudents"></div>
                <button class="btn" onclick="saveAttendance()">Salvar Presen√ßa</button>
            </div>
        </div>

        <!-- Gamification Tab -->
        <div id="gamificacao" class="tab-content">
            <h2>Sistema de Gamifica√ß√£o</h2>
            
            <div class="grid-2">
                <div class="card">
                    <h3 class="card-title">Ranking Geral</h3>
                    <div id="rankingList"></div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">Premia√ß√µes Ativas</h3>
                    <div class="action-buttons">
                        <button class="btn" onclick="openModal('achievementModal')">Nova Conquista</button>
                        <button class="btn btn-secondary" onclick="openModal('pointsModal')">Dar Pontos</button>
                    </div>
                    <div id="achievementsList"></div>
                </div>
            </div>
            
            <div class="card">
                <h3 class="card-title">Loja de Recompensas</h3>
                <div class="action-buttons">
                    <button class="btn" onclick="openModal('storeItemModal')">Novo Item</button>
                </div>
                <div id="storeItems"></div>
            </div>
        </div>

        <!-- Commission Tab -->
        <div id="comissoes" class="tab-content">
            <h2>Sistema de Comiss√µes</h2>
            <div class="action-buttons">
                <button class="btn" onclick="openModal('commissionModal')">Nova Comiss√£o</button>
                <button class="btn btn-secondary" onclick="calculateCommissions()">Calcular Per√≠odo</button>
            </div>
            
            <div class="grid-2">
                <div class="card">
                    <h3 class="card-title">Comiss√µes por Vendedor</h3>
                    <div id="commissionsList"></div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">Resumo do Per√≠odo</h3>
                    <div id="commissionSummary"></div>
                </div>
            </div>
        </div>

        <!-- Configuration Tab -->
        <div id="configuracao" class="tab-content">
            <div class="card">
                <h3 class="card-title">‚öôÔ∏è Configura√ß√µes</h3>
                
                <h4>Cursos Dispon√≠veis</h4>
                <div id="coursesList"></div>
                <div style="margin-top: 10px;">
                    <input type="text" id="newCourse" placeholder="Nome do novo curso" style="width: 300px;">
                    <button class="btn" onclick="addCourse()">Adicionar</button>
                </div>

                <h4 style="margin-top: 30px;">Backup e Restore</h4>
                <div class="action-buttons">
                    <button class="btn" onclick="exportData()">üì• Exportar Dados</button>
                    <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">üì§ Importar Dados</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
            </div>
        </div>
    </div>

    <!-- Student Modal -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('studentModal')">&times;</span>
            <h2 id="studentModalTitle">Cadastro de Participante</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Nome Completo: *</label>
                    <input type="text" id="studentName" required>
                </div>
                <div class="form-group">
                    <label>Email: *</label>
                    <input type="email" id="studentEmail" required>
                </div>
                <div class="form-group">
                    <label>Telefone:</label>
                    <input type="tel" id="studentPhone">
                </div>
                <div class="form-group">
                    <label>CPF:</label>
                    <input type="text" id="studentCPF">
                </div>
                <div class="form-group">
                    <label>Data de Nascimento:</label>
                    <input type="date" id="studentBirth">
                </div>
                <div class="form-group">
                    <label>Curso: *</label>
                    <select id="studentCourse" required>
                        <option value="">Selecione um curso</option>
                    </select>
                </div>
            </div>
            
            <h3>Respons√°vel Financeiro</h3>
            <div class="grid-2">
                <div class="form-group">
                    <label>Nome do Respons√°vel: *</label>
                    <input type="text" id="responsibleName" required>
                </div>
                <div class="form-group">
                    <label>Email do Respons√°vel: *</label>
                    <input type="email" id="responsibleEmail" required>
                </div>
                <div class="form-group">
                    <label>Telefone:</label>
                    <input type="tel" id="responsiblePhone">
                </div>
                <div class="form-group">
                    <label>CPF:</label>
                    <input type="text" id="responsibleCPF">
                </div>
            </div>
            
            <h3>Dados do Contrato</h3>
            <div class="grid-3">
                <div class="form-group">
                    <label>Valor Total: *</label>
                    <input type="number" id="contractValue" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Forma de Pagamento:</label>
                    <select id="paymentMethod">
                        <option value="avista">√Ä Vista</option>
                        <option value="parcelado">Parcelado</option>
                        <option value="cartao">Cart√£o</option>
                        <option value="boleto">Boleto</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>N√∫mero de Parcelas:</label>
                    <input type="number" id="installments" value="1" min="1" max="24">
                </div>
            </div>
            
            <button class="btn" onclick="saveStudent()">Salvar Participante</button>
            <input type="hidden" id="editingStudentId">
        </div>
    </div>

    <!-- Advanced Search Modal -->
    <div id="advancedSearchModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('advancedSearchModal')">&times;</span>
            <h2>Busca Avan√ßada</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Nome:</label>
                    <input type="text" id="searchName">
                </div>
                <div class="form-group">
                    <label>Status:</label>
                    <select id="searchStatus">
                        <option value="">Todos</option>
                        <option value="ativo">Ativo</option>
                        <option value="trancado">Trancado</option>
                        <option value="cancelado">Cancelado</option>
                        <option value="formado">Formado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Curso:</label>
                    <select id="searchCourse">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Situa√ß√£o Financeira:</label>
                    <select id="searchFinancial">
                        <option value="">Todas</option>
                        <option value="pago">Em Dia</option>
                        <option value="pendente">Pendente</option>
                        <option value="vencido">Vencido</option>
                    </select>
                </div>
            </div>
            <button class="btn" onclick="performAdvancedSearch()">Buscar</button>
            <button class="btn btn-secondary" onclick="clearAdvancedSearch()">Limpar</button>
        </div>
    </div>

    <!-- Document Generation Modal -->
    <div id="documentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('documentModal')">&times;</span>
            <h2>Gerar Documento</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Tipo de Documento:</label>
                    <select id="documentType">
                        <option value="declaracao">Declara√ß√£o</option>
                        <option value="trancamento">Trancamento</option>
                        <option value="cancelamento">Cancelamento</option>
                        <option value="contrato">Contrato</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Participante:</label>
                    <select id="documentStudent">
                        <option value="">Selecione um participante</option>
                    </select>
                </div>
            </div>
            <button class="btn" onclick="generateDocument()">Gerar</button>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('paymentModal')">&times;</span>
            <h2>Registrar Pagamento</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Participante:</label>
                    <select id="paymentStudent">
                        <option value="">Selecione um participante</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Valor:</label>
                    <input type="number" id="paymentValue" step="0.01">
                </div>
                <div class="form-group">
                    <label>Data do Pagamento:</label>
                    <input type="date" id="paymentDate">
                </div>
                <div class="form-group">
                    <label>M√©todo:</label>
                    <select id="paymentMethodPayment">
                        <option value="dinheiro">Dinheiro</option>
                        <option value="cartao">Cart√£o</option>
                        <option value="pix">PIX</option>
                        <option value="transferencia">Transfer√™ncia</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>Observa√ß√µes:</label>
                <textarea id="paymentNotes" rows="3"></textarea>
            </div>
            <button class="btn" onclick="savePayment()">Salvar</button>
        </div>
    </div>

    <!-- Progress Modal -->
    <div id="progressModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('progressModal')">&times;</span>
            <h2>Atualizar Progresso</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Participante:</label>
                    <select id="progressStudent">
                        <option value="">Selecione um participante</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Progresso (%):</label>
                    <input type="number" id="progressValue" min="0" max="100">
                </div>
            </div>
            <div class="form-group">
                <label>Observa√ß√µes:</label>
                <textarea id="progressNotes" rows="3"></textarea>
            </div>
            <button class="btn" onclick="saveProgress()">Salvar</button>
        </div>
    </div>

    <!-- Points Modal -->
    <div id="pointsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('pointsModal')">&times;</span>
            <h2>Dar Pontos</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Participante:</label>
                    <select id="pointsStudent">
                        <option value="">Selecione um participante</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Pontos:</label>
                    <input type="number" id="pointsValue" min="1">
                </div>
            </div>
            <div class="form-group">
                <label>Motivo:</label>
                <input type="text" id="pointsReason" placeholder="Ex: Participa√ß√£o em aula">
            </div>
            <button class="btn" onclick="givePoints()">Dar Pontos</button>
        </div>
    </div>

    <!-- Status Change Modal -->
    <div id="statusModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('statusModal')">&times;</span>
            <h2>Alterar Status</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Participante:</label>
                    <select id="statusStudent">
                        <option value="">Selecione um participante</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Novo Status:</label>
                    <select id="newStatus">
                        <option value="ativo">Ativo</option>
                        <option value="trancado">Trancado</option>
                        <option value="cancelado">Cancelado</option>
                        <option value="formado">Formado</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>Motivo:</label>
                <textarea id="statusReason" rows="3"></textarea>
            </div>
            <button class="btn" onclick="changeStatus()">Alterar Status</button>
        </div>
    </div>

    <!-- Turma Modal -->
    <div id="turmaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('turmaModal')">&times;</span>
            <h2>Nova Turma</h2>
            <div class="grid-2">
                <div class="form-group">
                    <label>Nome da Turma:</label>
                    <input type="text" id="turmaName">
                </div>
                <div class="form-group">
                    <label>Curso:</label>
                    <select id="turmaCourse">
                        <option value="">Selecione um curso</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Data de In√≠cio:</label>
                    <input type="date" id="turmaStart">
                </div>
                <div class="form-group">
                    <label>Data de Fim:</label>
                    <input type="date" id="turmaEnd">
                </div>
            </div>
            <button class="btn" onclick="saveTurma()">Salvar</button>
        </div>
    </div>

    <script>
        // Sistema de dados local
        const data = {
            students: [],
            courses: ['Desenvolvimento de Jogos', 'Design Gr√°fico', 'Programa√ß√£o Web', 'Mobile Development'],
            payments: [],
            turmas: [],
            attendance: [],
            achievements: [],
            storeItems: [],
            commissions: [],
            currentUser: null
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            loadStoredData();
            initializeTabs();
            populateSelects();
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
        });

        // Sistema de autentica√ß√£o
        function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email) {
                showNotification('Por favor, digite um email', 'error');
                return;
            }
            
            if (password !== '123456') {
                showNotification('Senha incorreta', 'error');
                return;
            }
            
            data.currentUser = { email, name: email.split('@')[0] };
            document.getElementById('userWelcome').textContent = `Bem-vindo, ${data.currentUser.name}!`;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            updateDashboard();
            loadStudentsTable();
            showNotification('Login realizado com sucesso!', 'success');
        }

        function logout() {
            data.currentUser = null;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
        }

        // Sistema de tabs
        function initializeTabs() {
            const tabs = [
                { id: 'dashboard', label: 'üìä Dashboard' },
                { id: 'students', label: 'üë• Participantes' },
                { id: 'turmas', label: 'üè´ Turmas' },
                { id: 'financeiro', label: 'üí∞ Financeiro' },
                { id: 'documentos', label: 'üìÑ Documentos' },
                { id: 'progresso', label: 'üìà Progresso' },
                { id: 'chamada', label: '‚úÖ Chamada' },
                { id: 'gamificacao', label: 'üèÜ Gamifica√ß√£o' },
                { id: 'comissoes', label: 'üíº Comiss√µes' },
                { id: 'configuracao', label: '‚öôÔ∏è Config' }
            ];

            const tabsContainer = document.getElementById('navTabs');
            tabs.forEach(tab => {
                const button = document.createElement('button');
                button.className = 'nav-tab';
                button.textContent = tab.label;
                button.onclick = () => switchTab(tab.id);
                if (tab.id === 'dashboard') button.classList.add('active');
                tabsContainer.appendChild(button);
            });
        }

        function switchTab(tabId) {
            // Remove active class from all tabs and content
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to selected tab and content
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
            
            // Load specific tab content
            switch(tabId) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'students':
                    loadStudentsTable();
                    break;
                case 'turmas':
                    loadTurmas();
                    break;
                case 'financeiro':
                    loadFinancialData();
                    break;
                case 'progresso':
                    loadProgressData();
                    break;
                case 'chamada':
                    loadAttendanceClasses();
                    break;
                case 'gamificacao':
                    loadGamificationData();
                    break;
                case 'comissoes':
                    loadCommissionsData();
                    break;
                case 'configuracao':
                    loadConfigurationData();
                    break;
            }
        }

        // Sistema de modais
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            
            // Populate selects based on modal
            if (modalId === 'studentModal') {
                populateCoursesSelect('studentCourse');
            } else if (modalId === 'documentModal') {
                populateStudentsSelect('documentStudent');
            } else if (modalId === 'paymentModal') {
                populateStudentsSelect('paymentStudent');
            } else if (modalId === 'progressModal') {
                populateStudentsSelect('progressStudent');
            } else if (modalId === 'pointsModal') {
                populateStudentsSelect('pointsStudent');
            } else if (modalId === 'statusModal') {
                populateStudentsSelect('statusStudent');
            } else if (modalId === 'turmaModal') {
                populateCoursesSelect('turmaCourse');
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            clearModalForms();
        }

        function clearModalForms() {
            document.querySelectorAll('.modal input, .modal select, .modal textarea').forEach(input => {
                if (input.type !== 'hidden') {
                    input.value = '';
                }
            });
        }

        // Sistema de notifica√ß√µes
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // Gest√£o de participantes
        function saveStudent() {
            const studentData = {
                id: document.getElementById('editingStudentId').value || Date.now().toString(),
                name: document.getElementById('studentName').value,
                email: document.getElementById('studentEmail').value,
                phone: document.getElementById('studentPhone').value,
                cpf: document.getElementById('studentCPF').value,
                birth: document.getElementById('studentBirth').value,
                course: document.getElementById('studentCourse').value,
                responsible: {
                    name: document.getElementById('responsibleName').value,
                    email: document.getElementById('responsibleEmail').value,
                    phone: document.getElementById('responsiblePhone').value,
                    cpf: document.getElementById('responsibleCPF').value
                },
                contract: {
                    value: parseFloat(document.getElementById('contractValue').value),
                    paymentMethod: document.getElementById('paymentMethod').value,
                    installments: parseInt(document.getElementById('installments').value)
                },
                status: 'ativo',
                progress: 0,
                points: 0,
                createdAt: new Date().toISOString()
            };

            if (!studentData.name || !studentData.email || !studentData.course || !studentData.responsible.name) {
                showNotification('Preencha todos os campos obrigat√≥rios', 'error');
                return;
            }

            const existingIndex = data.students.findIndex(s => s.id === studentData.id);
            if (existingIndex !== -1) {
                data.students[existingIndex] = { ...data.students[existingIndex], ...studentData };
                showNotification('Participante atualizado com sucesso!', 'success');
            } else {
                data.students.push(studentData);
                showNotification('Participante cadastrado com sucesso!', 'success');
                
                // Criar parcelas se necess√°rio
                if (studentData.contract.installments > 1) {
                    createInstallments(studentData);
                }
            }

            saveData();
            closeModal('studentModal');
            loadStudentsTable();
            updateDashboard();
        }

        function createInstallments(student) {
            const installmentValue = student.contract.value / student.contract.installments;
            const today = new Date();
            
            for (let i = 0; i < student.contract.installments; i++) {
                const dueDate = new Date(today);
                dueDate.setMonth(today.getMonth() + i);
                
                data.payments.push({
                    id: Date.now().toString() + i,
                    studentId: student.id,
                    studentName: student.name,
                    installment: i + 1,
                    value: installmentValue,
                    dueDate: dueDate.toISOString().split('T')[0],
                    status: 'pendente',
                    paymentDate: null,
                    method: null
                });
            }
        }

        function loadStudentsTable() {
            const tbody = document.getElementById('studentsTableBody');
            tbody.innerHTML = '';

            data.students.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.email}</td>
                    <td>${student.course}</td>
                    <td><span class="status-badge status-${student.status}">${student.status.toUpperCase()}</span></td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${student.progress}%"></div>
                        </div>
                        ${student.progress}%
                    </td>
                    <td><span class="points-display">${student.points} pts</span></td>
                    <td>
                        <button class="btn btn-small" onclick="editStudent('${student.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger" onclick="deleteStudent('${student.id}')">üóëÔ∏è</button>
                        <button class="btn btn-small btn-secondary" onclick="viewStudent('${student.id}')">üëÅÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function editStudent(studentId) {
            const student = data.students.find(s => s.id === studentId);
            if (!student) return;

            document.getElementById('editingStudentId').value = student.id;
            document.getElementById('studentName').value = student.name;
            document.getElementById('studentEmail').value = student.email;
            document.getElementById('studentPhone').value = student.phone || '';
            document.getElementById('studentCPF').value = student.cpf || '';
            document.getElementById('studentBirth').value = student.birth || '';
            document.getElementById('studentCourse').value = student.course;
            document.getElementById('responsibleName').value = student.responsible.name;
            document.getElementById('responsibleEmail').value = student.responsible.email;
            document.getElementById('responsiblePhone').value = student.responsible.phone || '';
            document.getElementById('responsibleCPF').value = student.responsible.cpf || '';
            document.getElementById('contractValue').value = student.contract.value;
            document.getElementById('paymentMethod').value = student.contract.paymentMethod;
            document.getElementById('installments').value = student.contract.installments;

            document.getElementById('studentModalTitle').textContent = 'Editar Participante';
            openModal('studentModal');
        }

        function deleteStudent(studentId) {
            if (confirm('Tem certeza que deseja excluir este participante?')) {
                data.students = data.students.filter(s => s.id !== studentId);
                data.payments = data.payments.filter(p => p.studentId !== studentId);
                saveData();
                loadStudentsTable();
                updateDashboard();
                showNotification('Participante exclu√≠do com sucesso!', 'success');
            }
        }

        function viewStudent(studentId) {
            const student = data.students.find(s => s.id === studentId);
            if (!student) return;

            const studentPayments = data.payments.filter(p => p.studentId === studentId);
            
            alert(`
Detalhes do Participante:
Nome: ${student.name}
Email: ${student.email}
Curso: ${student.course}
Status: ${student.status}
Progresso: ${student.progress}%
Pontos: ${student.points}
Respons√°vel: ${student.responsible.name}
Valor do Contrato: R$ ${student.contract.value.toFixed(2)}
Parcelas: ${studentPayments.length}
            `.trim());
        }

        // Sistema de busca
        function searchTable(searchTerm) {
            const tbody = document.getElementById('studentsTableBody');
            const rows = tbody.getElementsByTagName('tr');
            
            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm.toLowerCase()) ? '' : 'none';
            }
        }

        function advancedSearch() {
            populateCoursesSelect('searchCourse');
            openModal('advancedSearchModal');
        }

        function performAdvancedSearch() {
            const searchCriteria = {
                name: document.getElementById('searchName').value.toLowerCase(),
                status: document.getElementById('searchStatus').value,
                course: document.getElementById('searchCourse').value,
                financial: document.getElementById('searchFinancial').value
            };

            const filteredStudents = data.students.filter(student => {
                return (!searchCriteria.name || student.name.toLowerCase().includes(searchCriteria.name)) &&
                       (!searchCriteria.status || student.status === searchCriteria.status) &&
                       (!searchCriteria.course || student.course === searchCriteria.course);
            });

            displayFilteredStudents(filteredStudents);
            closeModal('advancedSearchModal');
        }

        function clearAdvancedSearch() {
            document.getElementById('searchName').value = '';
            document.getElementById('searchStatus').value = '';
            document.getElementById('searchCourse').value = '';
            document.getElementById('searchFinancial').value = '';
            loadStudentsTable();
        }

        function displayFilteredStudents(students) {
            const tbody = document.getElementById('studentsTableBody');
            tbody.innerHTML = '';

            students.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.email}</td>
                    <td>${student.course}</td>
                    <td><span class="status-badge status-${student.status}">${student.status.toUpperCase()}</span></td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${student.progress}%"></div>
                        </div>
                        ${student.progress}%
                    </td>
                    <td><span class="points-display">${student.points} pts</span></td>
                    <td>
                        <button class="btn btn-small" onclick="editStudent('${student.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger" onclick="deleteStudent('${student.id}')">üóëÔ∏è</button>
                        <button class="btn btn-small btn-secondary" onclick="viewStudent('${student.id}')">üëÅÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Dashboard
        function updateDashboard() {
            // Estat√≠sticas gerais
            const totalStudents = data.students.length;
            const activeStudents = data.students.filter(s => s.status === 'ativo').length;
            const totalCourses = data.courses.length;
            const totalClasses = data.turmas.length;

            document.getElementById('statsGrid').innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalStudents}</div>
                    <div class="stat-label">Total Participantes</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                    <div class="stat-number">${activeStudents}</div>
                    <div class="stat-label">Ativos</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);">
                    <div class="stat-number">${totalCourses}</div>
                    <div class="stat-label">Cursos</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #9C27B0 0%, #7B1FA2 100%);">
                    <div class="stat-number">${totalClasses}</div>
                    <div class="stat-label">Turmas</div>
                </div>
            `;

            // Resumo financeiro
            updateFinancialSummary();
            loadRecentActivities();
        }

        function updateFinancialSummary() {
            const totalReceita = data.payments.filter(p => p.status === 'pago').reduce((sum, p) => sum + p.value, 0);
            const totalVencido = data.payments.filter(p => p.status === 'vencido').reduce((sum, p) => sum + p.value, 0);
            const totalPendente = data.payments.filter(p => p.status === 'pendente').reduce((sum, p) => sum + p.value, 0);

            document.getElementById('totalReceita').textContent = `R$ ${totalReceita.toFixed(2)}`;
            document.getElementById('totalVencido').textContent = `R$ ${totalVencido.toFixed(2)}`;
            document.getElementById('totalPendente').textContent = `R$ ${totalPendente.toFixed(2)}`;
            
            // Duplicar para a aba financeira
            document.getElementById('totalReceita2').textContent = `R$ ${totalReceita.toFixed(2)}`;
            document.getElementById('totalVencido2').textContent = `R$ ${totalVencido.toFixed(2)}`;
            document.getElementById('totalPendente2').textContent = `R$ ${totalPendente.toFixed(2)}`;
        }

        function loadRecentActivities() {
            const activities = [
                'Novo participante cadastrado: Jo√£o Silva',
                'Pagamento recebido: R$ 450,00',
                'Turma "Desenvolvimento Mobile" criada',
                'Progresso atualizado: Maria Santos - 85%'
            ];

            document.getElementById('recentActivities').innerHTML = activities.map(activity => 
                `<div style="padding: 10px; border-left: 3px solid #2196F3; margin-bottom: 10px; background: #f8f9ff;">
                    ${activity}
                </div>`
            ).join('');
        }

        // Sistema financeiro
        function loadFinancialData() {
            updateFinancialSummary();
            loadPaymentsTable();
        }

        function loadPaymentsTable() {
            const tbody = document.getElementById('paymentsTableBody');
            tbody.innerHTML = '';

            data.payments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${payment.studentName}</td>
                    <td>${payment.installment}</td>
                    <td>R$ ${payment.value.toFixed(2)}</td>
                    <td>${new Date(payment.dueDate).toLocaleDateString('pt-BR')}</td>
                    <td><span class="status-badge status-${payment.status}">${payment.status.toUpperCase()}</span></td>
                    <td>
                        <button class="btn btn-small btn-success" onclick="markAsPaid('${payment.id}')">üí∞</button>
                        <button class="btn btn-small btn-warning" onclick="editPayment('${payment.id}')">‚úèÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function savePayment() {
            const paymentData = {
                id: Date.now().toString(),
                studentId: document.getElementById('paymentStudent').value,
                studentName: data.students.find(s => s.id === document.getElementById('paymentStudent').value)?.name || '',
                value: parseFloat(document.getElementById('paymentValue').value),
                paymentDate: document.getElementById('paymentDate').value,
                method: document.getElementById('paymentMethodPayment').value,
                notes: document.getElementById('paymentNotes').value,
                status: 'pago',
                installment: 1
            };

            if (!paymentData.studentId || !paymentData.value) {
                showNotification('Preencha todos os campos obrigat√≥rios', 'error');
                return;
            }

            data.payments.push(paymentData);
            saveData();
            closeModal('paymentModal');
            loadPaymentsTable();
            updateFinancialSummary();
            showNotification('Pagamento registrado com sucesso!', 'success');
        }

        function markAsPaid(paymentId) {
            const payment = data.payments.find(p => p.id === paymentId);
            if (payment) {
                payment.status = 'pago';
                payment.paymentDate = new Date().toISOString().split('T')[0];
                saveData();
                loadPaymentsTable();
                updateFinancialSummary();
                showNotification('Pagamento marcado como pago!', 'success');
            }
        }

        function generateFinancialReport() {
            const report = {
                totalReceita: data.payments.filter(p => p.status === 'pago').reduce((sum, p) => sum + p.value, 0),
                totalVencido: data.payments.filter(p => p.status === 'vencido').reduce((sum, p) => sum + p.value, 0),
                totalPendente: data.payments.filter(p => p.status === 'pendente').reduce((sum, p) => sum + p.value, 0),
                totalStudents: data.students.length,
                activeStudents: data.students.filter(s => s.status === 'ativo').length
            };

            alert(`
RELAT√ìRIO FINANCEIRO
====================
Receita Total: R$ ${report.totalReceita.toFixed(2)}
Valores Vencidos: R$ ${report.totalVencido.toFixed(2)}
Valores Pendentes: R$ ${report.totalPendente.toFixed(2)}

Total de Participantes: ${report.totalStudents}
Participantes Ativos: ${report.activeStudents}
            `.trim());
        }

        // Sistema de progresso
        function loadProgressData() {
            const container = document.getElementById('progressContainer');
            container.innerHTML = '';

            data.students.forEach(student => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <h4>${student.name}</h4>
                    <p>Curso: ${student.course}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${student.progress}%"></div>
                    </div>
                    <p>Progresso: ${student.progress}%</p>
                    <button class="btn btn-small" onclick="updateStudentProgress('${student.id}')">Atualizar</button>
                `;
                container.appendChild(card);
            });
        }

        function updateStudentProgress(studentId) {
            document.getElementById('progressStudent').value = studentId;
            openModal('progressModal');
        }

        function saveProgress() {
            const studentId = document.getElementById('progressStudent').value;
            const progress = parseInt(document.getElementById('progressValue').value);
            const notes = document.getElementById('progressNotes').value;

            const student = data.students.find(s => s.id === studentId);
            if (student) {
                student.progress = progress;
                saveData();
                closeModal('progressModal');
                loadProgressData();
                loadStudentsTable();
                showNotification('Progresso atualizado com sucesso!', 'success');
            }
        }

        function generateProgressReport() {
            const studentsWithProgress = data.students.map(student => ({
                name: student.name,
                course: student.course,
                progress: student.progress,
                status: student.status
            }));

            console.log('Relat√≥rio de Progresso:', studentsWithProgress);
            alert('Relat√≥rio de progresso gerado! Verifique o console para detalhes.');
        }

        // Sistema de presen√ßa
        function loadAttendanceClasses() {
            const select = document.getElementById('attendanceClass');
            select.innerHTML = '<option value="">Selecione uma turma</option>';
            
            data.turmas.forEach(turma => {
                const option = document.createElement('option');
                option.value = turma.id;
                option.textContent = turma.name;
                select.appendChild(option);
            });
        }

        function loadAttendanceList() {
            const classId = document.getElementById('attendanceClass').value;
            const date = document.getElementById('attendanceDate').value;

            if (!classId || !date) {
                showNotification('Selecione uma turma e data', 'error');
                return;
            }

            const turma = data.turmas.find(t => t.id === classId);
            if (!turma) return;

            const studentsInClass = data.students.filter(s => s.course === turma.course);
            const attendanceContainer = document.getElementById('attendanceStudents');
            
            attendanceContainer.innerHTML = studentsInClass.map(student => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border: 1px solid #e0e0e0; margin: 5px 0; border-radius: 5px;">
                    <span>${student.name}</span>
                    <label>
                        <input type="checkbox" data-student-id="${student.id}" checked> Presente
                    </label>
                </div>
            `).join('');

            document.getElementById('attendanceList').classList.remove('hidden');
        }

        function saveAttendance() {
            const classId = document.getElementById('attendanceClass').value;
            const date = document.getElementById('attendanceDate').value;
            const checkboxes = document.querySelectorAll('#attendanceStudents input[type="checkbox"]');

            const attendanceData = {
                id: Date.now().toString(),
                classId,
                date,
                students: []
            };

            checkboxes.forEach(checkbox => {
                attendanceData.students.push({
                    studentId: checkbox.dataset.studentId,
                    present: checkbox.checked
                });
            });

            data.attendance.push(attendanceData);
            saveData();
            showNotification('Presen√ßa salva com sucesso!', 'success');
            document.getElementById('attendanceList').classList.add('hidden');
        }

        // Sistema de gamifica√ß√£o
        function loadGamificationData() {
            loadRanking();
            loadAchievements();
            loadStoreItems();
        }

        function loadRanking() {
            const sortedStudents = [...data.students].sort((a, b) => b.points - a.points);
            const container = document.getElementById('rankingList');
            
            container.innerHTML = sortedStudents.slice(0, 10).map((student, index) => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: ${index < 3 ? '#fff3cd' : '#f8f9fa'}; margin: 5px 0; border-radius: 5px;">
                    <span>${index + 1}¬∫ ${student.name}</span>
                    <span class="points-display">${student.points} pts</span>
                </div>
            `).join('');
        }

        function loadAchievements() {
            const container = document.getElementById('achievementsList');
            container.innerHTML = `
                <div class="achievement-badge">üèÜ Primeiro Login</div>
                <div class="achievement-badge">üìö 100% de Presen√ßa</div>
                <div class="achievement-badge">‚≠ê Top 3 Ranking</div>
                <div class="achievement-badge">üéØ Meta Mensal</div>
            `;
        }

        function loadStoreItems() {
            const container = document.getElementById('storeItems');
            const items = [
                { name: 'Desconto 10%', cost: 100, description: 'Desconto na pr√≥xima mensalidade' },
                { name: 'Material Extra', cost: 50, description: 'Acesso a conte√∫do adicional' },
                { name: 'Certificado Premium', cost: 200, description: 'Certificado com selo especial' }
            ];

            container.innerHTML = items.map(item => `
                <div class="store-item">
                    <div>
                        <h4>${item.name}</h4>
                        <p>${item.description}</p>
                    </div>
                    <div>
                        <span class="points-display">${item.cost} pts</span>
                        <button class="btn btn-small">Trocar</button>
                    </div>
                </div>
            `).join('');
        }

        function givePoints() {
            const studentId = document.getElementById('pointsStudent').value;
            const points = parseInt(document.getElementById('pointsValue').value);
            const reason = document.getElementById('pointsReason').value;

            if (!studentId || !points) {
                showNotification('Preencha todos os campos', 'error');
                return;
            }

            const student = data.students.find(s => s.id === studentId);
            if (student) {
                student.points += points;
                saveData();
                closeModal('pointsModal');
                loadStudentsTable();
                loadRanking();
                showNotification(`${points} pontos dados para ${student.name}!`, 'success');
            }
        }

        // Sistema de turmas
        function loadTurmas() {
            const container = document.getElementById('turmasContainer');
            container.innerHTML = '';

            data.turmas.forEach(turma => {
                const studentsInClass = data.students.filter(s => s.course === turma.course).length;
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <h4>${turma.name}</h4>
                    <p>Curso: ${turma.course}</p>
                    <p>In√≠cio: ${new Date(turma.startDate).toLocaleDateString('pt-BR')}</p>
                    <p>Fim: ${new Date(turma.endDate).toLocaleDateString('pt-BR')}</p>
                    <p>Participantes: ${studentsInClass}</p>
                    <button class="btn btn-small btn-danger" onclick="deleteTurma('${turma.id}')">Excluir</button>
                `;
                container.appendChild(card);
            });
        }

        function saveTurma() {
            const turmaData = {
                id: Date.now().toString(),
                name: document.getElementById('turmaName').value,
                course: document.getElementById('turmaCourse').value,
                startDate: document.getElementById('turmaStart').value,
                endDate: document.getElementById('turmaEnd').value,
                createdAt: new Date().toISOString()
            };

            if (!turmaData.name || !turmaData.course) {
                showNotification('Preencha todos os campos obrigat√≥rios', 'error');
                return;
            }

            data.turmas.push(turmaData);
            saveData();
            closeModal('turmaModal');
            loadTurmas();
            showNotification('Turma criada com sucesso!', 'success');
        }

        function deleteTurma(turmaId) {
            if (confirm('Tem certeza que deseja excluir esta turma?')) {
                data.turmas = data.turmas.filter(t => t.id !== turmaId);
                saveData();
                loadTurmas();
                showNotification('Turma exclu√≠da com sucesso!', 'success');
            }
        }

        // Sistema de comiss√µes
        function loadCommissionsData() {
            const container = document.getElementById('commissionsList');
            container.innerHTML = `
                <div class="commission-card">
                    <h4>Jo√£o Vendedor</h4>
                    <p>Vendas: R$ 5.000,00</p>
                    <p>Comiss√£o (10%): R$ 500,00</p>
                </div>
                <div class="commission-card">
                    <h4>Maria Vendedora</h4>
                    <p>Vendas: R$ 3.200,00</p>
                    <p>Comiss√£o (10%): R$ 320,00</p>
                </div>
            `;

            document.getElementById('commissionSummary').innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">R$ 8.200,00</div>
                    <div class="stat-label">Total Vendas</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                    <div class="stat-number">R$ 820,00</div>
                    <div class="stat-label">Total Comiss√µes</div>
                </div>
            `;
        }

        function calculateCommissions() {
            showNotification('Comiss√µes calculadas para o per√≠odo!', 'success');
            loadCommissionsData();
        }

        // Sistema de status
        function changeStatus() {
            const studentId = document.getElementById('statusStudent').value;
            const newStatus = document.getElementById('newStatus').value;
            const reason = document.getElementById('statusReason').value;

            if (!studentId || !newStatus) {
                showNotification('Preencha todos os campos', 'error');
                return;
            }

            const student = data.students.find(s => s.id === studentId);
            if (student) {
                student.status = newStatus;
                saveData();
                closeModal('statusModal');
                loadStudentsTable();
                updateDashboard();
                showNotification(`Status alterado para ${newStatus}!`, 'success');
            }
        }

        // Sistema de documentos
        function generateDocument() {
            const studentId = document.getElementById('documentStudent').value;
            const docType = document.getElementById('documentType').value;

            if (!studentId) {
                showNotification('Selecione um participante', 'error');
                return;
            }

            const student = data.students.find(s => s.id === studentId);
            if (!student) return;

            let documentHTML = '';
            const today = new Date().toLocaleDateString('pt-BR');

            switch(docType) {
                case 'declaracao':
                    documentHTML = `
                        <div class="document-preview">
                            <div class="document-header">
                                <h2>DECLARA√á√ÉO</h2>
                                <p>GameCreators - Instituto de Tecnologia</p>
                            </div>
                            <p>Declaramos para os devidos fins que <strong>${student.name}</strong>, 
                            portador do email ${student.email}, est√° regularmente matriculado(a) 
                            no curso de <strong>${student.course}</strong> nesta institui√ß√£o.</p>
                            
                            <p>O referido aluno encontra-se com situa√ß√£o acad√™mica <strong>${student.status}</strong> 
                            e progresso de <strong>${student.progress}%</strong> no curso.</p>
                            
                            <p>Por ser verdade, firmamos a presente declara√ß√£o.</p>
                            
                            <br><br>
                            <p style="text-align: center;">
                                _________________________________<br>
                                GameCreators<br>
                                ${today}
                            </p>
                        </div>
                        <div class="no-print">
                            <button class="btn" onclick="window.print()">üñ®Ô∏è Imprimir</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('documentPreview').innerHTML=''">Fechar</button>
                        </div>
                    `;
                    break;
                case 'contrato':
                    documentHTML = `
                        <div class="document-preview">
                            <div class="document-header">
                                <h2>CONTRATO DE PRESTA√á√ÉO DE SERVI√áOS EDUCACIONAIS</h2>
                                <p>GameCreators - Instituto de Tecnologia</p>
                            </div>
                            <p><strong>CONTRATANTE:</strong> ${student.responsible.name}<br>
                            <strong>CONTRATADO:</strong> GameCreators</p>
                            
                            <p><strong>PARTICIPANTE:</strong> ${student.name}<br>
                            <strong>CURSO:</strong> ${student.course}<br>
                            <strong>VALOR:</strong> R$ ${student.contract.value.toFixed(2)}<br>
                            <strong>PARCELAS:</strong> ${student.contract.installments}x</p>
                            
                            <p>O presente contrato tem por objetivo a presta√ß√£o de servi√ßos educacionais 
                            na √°rea de ${student.course}, conforme grade curricular estabelecida.</p>
                            
                            <br><br>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 50px; text-align: center;">
                                <div>
                                    _________________________________<br>
                                    Contratante
                                </div>
                                <div>
                                    _________________________________<br>
                                    GameCreators
                                </div>
                            </div>
                            <p style="text-align: center; margin-top: 20px;">${today}</p>
                        </div>
                        <div class="no-print">
                            <button class="btn" onclick="window.print()">üñ®Ô∏è Imprimir</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('documentPreview').innerHTML=''">Fechar</button>
                        </div>
                    `;
                    break;
            }

            document.getElementById('documentPreview').innerHTML = documentHTML;
            closeModal('documentModal');
            showNotification('Documento gerado com sucesso!', 'success');
        }

        // Sistema de configura√ß√£o
        function loadConfigurationData() {
            const container = document.getElementById('coursesList');
            container.innerHTML = data.courses.map(course => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border: 1px solid #e0e0e0; margin: 5px 0; border-radius: 5px;">
                    <span>${course}</span>
                    <button class="btn btn-small btn-danger" onclick="removeCourse('${course}')">Remover</button>
                </div>
            `).join('');
        }

        function addCourse() {
            const courseName = document.getElementById('newCourse').value.trim();
            if (!courseName) {
                showNotification('Digite o nome do curso', 'error');
                return;
            }

            if (data.courses.includes(courseName)) {
                showNotification('Curso j√° existe', 'error');
                return;
            }

            data.courses.push(courseName);
            saveData();
            loadConfigurationData();
            populateSelects();
            document.getElementById('newCourse').value = '';
            showNotification('Curso adicionado com sucesso!', 'success');
        }

        function removeCourse(courseName) {
            if (confirm(`Tem certeza que deseja remover o curso "${courseName}"?`)) {
                data.courses = data.courses.filter(course => course !== courseName);
                saveData();
                loadConfigurationData();
                populateSelects();
                showNotification('Curso removido com sucesso!', 'success');
            }
        }

        // Sistema de backup
        function exportData() {
            const dataToExport = {
                ...data,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };

            const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `gamecreators_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Dados exportados com sucesso!', 'success');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (confirm('Isso ir√° substituir todos os dados atuais. Deseja continuar?')) {
                        Object.assign(data, importedData);
                        saveData();
                        loadStudentsTable();
                        updateDashboard();
                        loadConfigurationData();
                        populateSelects();
                        showNotification('Dados importados com sucesso!', 'success');
                    }
                } catch (error) {
                    showNotification('Erro ao importar dados. Verifique o arquivo.', 'error');
                }
            };
            reader.readAsText(file);
        }

        // Utilit√°rios
        function populateSelects() {
            populateCoursesSelect('studentCourse');
            populateCoursesSelect('searchCourse');
            populateCoursesSelect('turmaCourse');
        }

        function populateCoursesSelect(selectId) {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            const currentValue = select.value;
            select.innerHTML = '<option value="">Selecione um curso</option>';
            
            data.courses.forEach(course => {
                const option = document.createElement('option');
                option.value = course;
                option.textContent = course;
                select.appendChild(option);
            });
            
            select.value = currentValue;
        }

        function populateStudentsSelect(selectId) {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            select.innerHTML = '<option value="">Selecione um participante</option>';
            
            data.students.forEach(student => {
                const option = document.createElement('option');
                option.value = student.id;
                option.textContent = student.name;
                select.appendChild(option);
            });
        }

        // Sistema de armazenamento
        function saveData() {
            // Em um ambiente real, isso seria enviado para um servidor
            // Por enquanto, vamos simular o armazenamento local
            console.log('Dados salvos:', data);
        }

        function loadStoredData() {
            // Em um ambiente real, isso carregaria dados do servidor
            // Por enquanto, vamos usar dados de exemplo
            if (data.students.length === 0) {
                // Dados de exemplo
                data.students = [
                    {
                        id: '1',
                        name: 'Jo√£o Silva',
                        email: 'joao@email.com',
                        phone: '(11) 99999-9999',
                        course: 'Desenvolvimento de Jogos',
                        status: 'ativo',
                        progress: 65,
                        points: 120,
                        responsible: {
                            name: 'Maria Silva',
                            email: 'maria@email.com'
                        },
                        contract: {
                            value: 1200.00,
                            paymentMethod: 'parcelado',
                            installments: 12
                        }
                    },
                    {
                        id: '2',
                        name: 'Ana Santos',
                        email: 'ana@email.com',
                        phone: '(11) 88888-8888',
                        course: 'Design Gr√°fico',
                        status: 'ativo',
                        progress: 80,
                        points: 200,
                        responsible: {
                            name: 'Carlos Santos',
                            email: 'carlos@email.com'
                        },
                        contract: {
                            value: 900.00,
                            paymentMethod: 'parcelado',
                            installments: 6
                        }
                    }
                ];

                data.payments = [
                    {
                        id: '1',
                        studentId: '1',
                        studentName: 'Jo√£o Silva',
                        installment: 1,
                        value: 100.00,
                        dueDate: '2024-01-15',
                        status: 'pago'
                    },
                    {
                        id: '2',
                        studentId: '1',
                        studentName: 'Jo√£o Silva',
                        installment: 2,
                        value: 100.00,
                        dueDate: '2024-02-15',
                        status: 'pendente'
                    },
                    {
                        id: '3',
                        studentId: '2',
                        studentName: 'Ana Santos',
                        installment: 1,
                        value: 150.00,
                        dueDate: '2024-01-10',
                        status: 'vencido'
                    }
                ];

                data.turmas = [
                    {
                        id: '1',
                        name: 'Turma A - Jogos 2024',
                        course: 'Desenvolvimento de Jogos',
                        startDate: '2024-01-15',
                        endDate: '2024-12-15'
                    }
                ];
            }
        }

        // Event listeners para Enter key
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (document.getElementById('loginScreen').style.display !== 'none') {
                    login();
                }
            }
        });

        // Fechar modais ao clicar fora
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
                clearModalForms();
            }
        }
    </script>
</body>
</html>
